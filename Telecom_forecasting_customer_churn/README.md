# Телеком - прогнозирование оттока клиентов

[ipynb](https://github.com/apashina/data-science-yandex-praktikum/blob/main/Telecom_forecasting_customer_churn/16_telecom_forecasting_customer_churn.ipynb)

## Используемые инструменты

 `python` `pandas` `numpy` `matplotlib` `seaborn` `sklearn` `lightgbm` `catboost`

## Описание проекта

Оператор связи «Ниединогоразрыва.ком» хочет научиться прогнозировать отток клиентов. Если выяснится, что пользователь планирует уйти, ему будут предложены промокоды и специальные условия. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и договорах.

**Цель проекта** – подготовить прототип модели машинного обучения, предсказывающей уйдёт клиент от оператора связи в ближайшее время или нет. Требуется построить модель со значением метрики *AUC-ROC* не менее 0.85.

**Задачи:**

1. Составить план работы.
2. Уточнить задачу.
3. Разработать модель.
4. Подготовить отчёт.

**Описание данных**

Оператор предоставляет два основных типа услуг: 

1. Стационарную телефонную связь. Возможно подключение телефонного аппарата к нескольким линиям одновременно.
2. Интернет. Подключение может быть двух типов: через телефонную линию (DSL*,* от англ. *digital subscriber line*, «цифровая абонентская линия») или оптоволоконный кабель (*Fiber optic*).  

Также доступны другие интернет-услуги, они описаны ниже (таблица `internet`).

За услуги клиенты могут платить каждый месяц или заключить договор на 1–2 года. Доступны различные способы расчёта и возможность получения электронного чека.

Данные состоят из файлов, полученных из разных источников:

- `contract.csv` — информация о договоре,
- `personal.csv` — персональные данные клиента,
- `internet.csv` — информация об интернет-услугах,
- `phone.csv` — информация об услугах телефонии.

Информация о договорах актуальна на 1 февраля 2020.

- `customerID` – код клиента (во всех файлах).

Таблица `contract`:

- `BeginDate` – дата начала пользования услугами,
- `EndDate` – дата окончания пользования услугами,
- `Type` – тип оплаты: ежемесячный, годовой и тд,
- `PaperlessBilling` – электронный платёжный документ,
- `PaymentMethod` – способ оплаты,
- `MonthlyCharges` – ежемесячные траты на услуги,
- `TotalCharges` – всего потрачено денег на услуги.

Таблица `personal`:

- `gender` – пол клиента,
- `SeniorCitizen` – наличие пенсионного статуса по возрасту,
- `Partner` – наличие супруга(и),
- `Dependents` – наличие иждивенцев.

Таблица `internet`:

- `InternetService` – тип подключения к интернету,
- `OnlineSecurity` – наличие блокировки небезопасных сайтов,
- `OnlineBackup` – наличие облачного хранилища файлов для резервного копирования данных,
- `DeviceProtection` – наличие антивируса,
- `TechSupport` – наличие выделенной линии технической поддержки,
- `StreamingTV` – наличие стримингового телевидения,
- `StreamingMovies` – наличие каталога фильмов.

Таблица `phone`:

- `MultipleLines` – наличие возможности ведения параллельных линий во время звонка.

## Вывод

При изучении файлов с данными не выявлено пропусков и дубликатов. После объединения таблиц появились пропуски, которые были обработаны после анализа данных. Некоторые колонки требовали изменения типа данных. Также были созданы дополнительные признаки. 
Разведочный анализ данных позволил составить портрет клиента оператора связи и оценить риск оттока пользователей, а также оценить связь между признаками. На основе вышесказанного было исключено несколько признаков из датафрейма, которые не оказывают влияние на качество предсказаний.

Данные были разделены на обучающую и тестовую выборки в соотношении 3:1 с учетом дисбаланса классов в целевом признаке. Для моделей `RandomForestClassifier` и `LogisticRegression` категориальные признаки подверглись кодированию, для последней также выполнялось масштабирование численных признаков. В случае моделей `CatBoostClassifier` и `LGBMClassifier` использовались встроенные кодировщики, но для `LGBMClassifier` предварительно потребовалось приведение категориальных признаков к типу 'category'.

Упомянутые выше модели были построены и обучены с помощью рандомизированного поиска по сетке гиперпараметров. В результате по критерю максимизации метрики качества *ROC-AUC* наилучшей оказалась модель `CatBoostClassifier` с ***ROC-AUC* = 0.92**.

Окончательная проверка качества модели `CatBoostClassifier` на тестовой выборке показала значение ***ROC-AUC* = 0.94**. Адекватность построенной модели подтвердилась путем сравнения значения метрики *AUC-ROC* со значением 0.5 для случайной модели.
