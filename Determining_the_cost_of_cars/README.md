# Определение стоимости автомобилей

[ipynb](https://github.com/apashina/data-science-yandex-praktikum/blob/main/Determining_the_cost_of_cars/11_determining_the_cost_of_cars.ipynb)

## Используемые инструменты

`python` `pandas` `numpy` `matplotlib` `sklearn` `lightgbm` `catboost`

## Ход исследования

* Обоснование актуальности выбранной темы
* Определение объекта и предмета исследования
* Постановка цели и конкретных задач
* Разработка гипотезы
* Выбор методов решения поставленных задач
* Проведение исследования
* Обработка результатов исследования
* Формулирование выводов и оценка полученных результатов
* Оформление работы

## Описание проекта

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение, чтобы привлечь новых клиентов. В нём можно будет узнать рыночную стоимость своего автомобиля. В нашем распоряжении данные о технических характеристиках, комплектации и ценах других автомобилей.

**Цель проекта** – построить модель, предсказывающую рыночную стоимость автомобиля клиента.

**Критерии, которые важны заказчику:**

- качество предсказания - значение метрики RMSE должно быть меньше 2500 евро,
- время обучения модели,
- время предсказания модели.

### Шаги

1. Загрузить данные.
2. Изучить данные. Заполнить пропущенные значения и обработать аномалии в столбцах. Если среди признаков имеются неинформативные, удалить их.
3. Подготовить выборки для обучения моделей.
4. Обучить разные модели, одна из которых - LightGBM, как минимум одна - не бустинг.
5. Проанализировать время обучения, время предсказания и качество моделей.
6. Опираясь на критерии заказчика, выбрать лучшую модель, проверить её качество на тестовой выборке.

### Описание данных

**Признаки**

* `DateCrawled` — дата скачивания анкеты из базы,
* `VehicleType` — тип автомобильного кузова,
* `RegistrationYear` — год регистрации автомобиля,
* `Gearbox` — тип коробки передач,
* `Power` — мощность (л. с.),
* `Model` — модель автомобиля,
* `Kilometer` — пробег (км),
* `RegistrationMonth` — месяц регистрации автомобиля,
* `FuelType` — тип топлива,
* `Brand` — марка автомобиля,
* `Repaired` — была машина в ремонте или нет,
* `DateCreated` — дата создания анкеты,
* `NumberOfPictures` — количество фотографий автомобиля,
* `PostalCode` — почтовый индекс владельца анкеты (пользователя),
* `LastSeen` — дата последней активности пользователя.

**Целевой признак**

* `Price` — цена (евро).

## Вывод

Было проведено исследование, позволившее построить модель для задачи регрессии, которая прогнозирует рыночную стоимость автомобиля. Входные данные – данные о технических характеристиках, комплектации и ценах других автомобилей.

Изучение файла с данными и исследовательский анализ данных показали необходимость предобработки. Пропущенные значения и аномалии были заполнены и устранены соответственно. Также из датасета были удалены признаки, не несущие информацию для предсказания. На этапе предобработки было потеряно 9.67 % наблюдений от исходных данных.

Данные были разделены на обучающую и тестовую выборки в соотношении 3:1. Для моделей `RandomForestRegressor` и `ElasticNet` имеющиеся категориальные признаки подверглись кодированию, для последней также выполнялось масштабирование численных признаков. В случае моделей `CatBoostRegressor` и `LGBMRegressor` использовались встроенные кодировщики, но для `LGBMRegressor` предварительно потребовалось приведение категориальных признаков к типу *category*.

Упомянутые выше модели были построены и обучены с помощью рандомизированного поиска по гиперпараметрам. В результате по критериям качества предсказания и скорости обучения наилучшей оказалась модель **`LightGBM` с *RMSE* = 1556.71 евро, временем обучения 13.85 с и временем предсказания 7.66 с**.

Адекватность построенных моделей подтвердилась путем сравнения с работой константной модели `DummyRegressor`, ***RMSE***  которой составила **4539.33 евро**.

Окончательная проверка качества модели `LightGBM` на тестовой выборке показала значение ***RMSE* 1548.62 евро**.
