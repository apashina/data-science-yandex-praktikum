# Восстановление золота из руды

[ipynb](https://github.com/apashina/data-science-yandex-praktikum/blob/545c51dc68a334135de631d9b2c7d88fca7f327e/Recovery_of_gold_from_ore/09_recovery_of_gold_from_ore.ipynb)

## Используемые инструменты

`python` `pandas` `numpy` `matplotlib` `seaborn` `sklearn`

## Описание проекта

Компания «Цифра» разрабатывает решения для эффективной работы промышленных предприятий.

**Цель проекта** – подготовить прототип модели машинного обучения, предсказывающей коэффициент восстановления золота из золотосодержащей руды, для компании «Цифра».

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

**Задачи:** 

1. Подготовить данные.
2. Провести исследовательский анализ данных.
3. Построить и обучить модель.

**Описание данных**

В нашем распоряжении сырые данные с параметрами добычи и очистки. Данные находятся в трёх файлах:

* `gold_recovery_train_new.csv` — обучающая выборка,
* `gold_recovery_test_new.csv` — тестовая выборка,
* `gold_recovery_full_new.csv` — исходные данные.

Данные индексируются датой и временем получения информации (признак `date`). Соседние по времени параметры часто похожи.

Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.

Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.

**Технологический процесс**

* *Rougher feed* — исходное сырье,
* *Rougher additions* (или *reagent additions*) — флотационные реагенты: Xanthate, Sulphate, Depressant,
* *Rougher process* (англ. «грубый процесс») — флотация,
* *Rougher tails* — отвальные хвосты,
* *Float banks* — флотационная установка,
* *Cleaner process* — очистка,
* *Rougher Au* — черновой концентрат золота,
* *Final Au* — финальный концентрат золота.

**Параметры этапов**

* *air amount* — объём воздуха,
* *fluid levels* — уровень жидкости,
* *feed size* — размер гранул сырья,
* *feed rate* — скорость подачи.

**Наименование признаков**

`[этап].[тип_параметра].[название_параметра]`

Возможные значения для блока `[этап]`:

* *rougher* — флотация,
* *primary_cleaner* — первичная очистка,
* *secondary_cleaner* — вторичная очистка,
* *final* — финальные характеристики.

Возможные значения для блока `[тип_параметра]`:

* *input* — параметры сырья,
* *output* — параметры продукта,
* *state* — параметры, характеризующие текущее состояние этапа,
* *calculation* — расчётные характеристики.

## Вывод

Требовалось спрогнозировать сразу две величины: эффективность обогащения чернового концентрата `rougher.output.recovery` и
эффективность обогащения финального концентрата `final.output.recovery`. С этой целью были построены и обучены несколько моделей с помощью рандомизированного поиска по гиперпараметрам (`RandomizedSearchCV`). В результате наилучшими оказалась модели регресси, обученные **алгоритмом случайного леса**, с **итоговой метрикой *sMAPE* 8.18 %**:

* гипрепараметры модели, предсказывающей `rougher.output.recovery` - `max_depth=17`, `min_samples_split=162`, `n_estimators=40`,
* гипрепараметры модели, предсказывающей `final.output.recovery` - `max_depth=11`, `min_samples_leaf=121`, `min_samples_split=162`, `n_estimators=160`.

Адекватность построенных моделей подтвердилась путем сравнения с работой константной модели `DummyRegressor`, **итоговая *sMAPE*** которой составила **9.45 %**.

Окончательная проверка качества моделей на тестовой выборке показала значение **итоговой *sMAPE* 9.27 %**.
