# Прогнозирование оттока клиентов банка

[ipynb](https://github.com/apashina/data-science-yandex-praktikum/blob/main/Bank_customer_churn/07_bank_customer_churn.ipynb)

## Используемые инструменты

`python` `pandas` `numpy` `matplotlib` `sklearn` `imblearn`

## Ход исследования

* Обоснование актуальности выбранной темы
* Определение объекта и предмета исследования
* Постановка цели и конкретных задач
* Разработка гипотезы
* Выбор методов решения поставленных задач
* Проведение исследования
* Обработка результатов исследования
* Формулирование выводов и оценка полученных результатов
* Оформление работы

## Описание проекта

Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых. 

**Цель проекта** – спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Требуется построить модель с предельно большим значением F1-меры, дополнительно сравнивая последнее со значением AUC-ROC.

### Шаги

- загрузить и подготовить данные,
- исследовать баланс классов, обучить модель без учёта дисбаланса,
- улучшить качество модели, учитывая дисбаланс классов; обучить разные модели и найти лучшую,
- провести финальное тестирование,
- сформулировать общий вывод.

### Описание данных

В нашем распоряжении исторические данные о поведении клиентов и расторжении договоров с банком.

* `RowNumber` — индекс строки в данных,
* `CustomerId` — уникальный идентификатор клиента,
* `Surname` — фамилия,
* `CreditScore` — кредитный рейтинг,
* `Geography` — страна проживания,
* `Gender` — пол,
* `Age` — возраст,
* `Tenure` — сколько лет человек является клиентом банка,
* `Balance` — баланс на счёте,
* `NumOfProducts` — количество продуктов банка, используемых клиентом,
* `HasCrCard` — наличие кредитной карты,
* `IsActiveMember` — активность клиента,
* `EstimatedSalary` — предполагаемая зарплата,
* `Exited` — факт ухода клиента.

## Вывод

Было проведено исследование, позволившее построить модель для задачи классификации, которая прогнозирует, уйдёт клиент из банка в ближайшее время или нет. Входные данные – данные о поведении клиентов и расторжении договоров с банком.

При изучении файла с данными не выявлено аномалий и существенных выбросов в признаках. В колонке `tenure` были обработаны пропущенные значения и изменен тип данных. Из датасета были удалены три признака, не несущие информацию для предсказания. Имеющиеся категориальные признаки были обработаны техникой прямого кодирования. 

Данные были разделены на обучающую, валидационную и тестовую выборки в соотношении 3:1:1 с учетом дисбаланса классов в целевом признаке. Размеры получившихся выборок следующие: обучающей – 6000 строк, валидационной и тестовой – по 2000 строк соответственно. Количественные признаки были отмасштабированы методом стандартизации данных.

Был обнаружен дисбаланс классов 1:4, модели обучались и с учетом, и без учета дисбаланса. Для борьбы с дисбалансом использовались две техники - RandomUnderSampler (уменьшает число примеров мажоритарного класса) и SMOTE (увеличивает число примеров миноритарного класса).

Были рассмотрены 3 алгоритма обучения – решающее дерево, случайный лес и логистическая регрессия. Валидационная выборка в каждом случае использовалась для подбора гиперпараметров моделей, обеспечивающих наибольшее значение F1-меры. В результате наилучшей оказалась модель классификации случайным лесом, обученная на сбалансированной техникой SMOTE тренировочной выборке, с F1-мера - 0.641 и AUC-ROC - 0.869.

Адекватность построенных моделей подтвердилась путем сравнения значений метрики AUC-ROC со значением 0.5 для случайной модели.

Окончательная проверка качества модели на тестовой выборке показала значение F1-меры - 0.604 и AUC-ROC - 0.854.
