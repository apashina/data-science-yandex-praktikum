# Анализ тональности англоязычного текста

[ipynb](https://github.com/apashina/data-science-yandex-praktikum/blob/main/Analysis_of_text_tonality/13_analysis_of_text_tonality.ipynb)

## Используемые инструменты

`python` `pandas` `numpy` `matplotlib` `nltk` `imblearn` `sklearn` `lightgbm` `catboost`

## Описание проекта

Интернет-магазин «Викишоп» запускает новый сервис. Теперь пользователи могут редактировать и дополнять описания товаров, как в вики-сообществах. То есть клиенты предлагают свои правки и комментируют изменения других. Магазину нужен инструмент, который будет искать токсичные комментарии и отправлять их на модерацию. В нашем распоряжении набор данных с разметкой о токсичности правок.

**Цель проекта** – построить модель, классифицирующую комментарии на позитивные и негативные, со значением метрики качества F1 не меньше 0.75.

**Задачи:** 

1. Загрузить и подготовить данные.
2. Обучить разные модели.
3. Сделать выводы.

***Описание данных***

* `text` – текст комментария, 
* `toxic` – целевой признак.

## Вывод

Было проведено исследование, позволившее построить модель для задачи классификации, которая прогнозирует эмоциональную окраску англоязычного текста. Модель поможет компании искать токсичные комментарии и отправлять их на модерацию. Входные данные - набор данных с разметкой о токсичности правок клиентов.

При изучении файла с данными не выявлено пропусков и дубликатов, обнаружен дисбаланс классов 9:1. Проведена очистка и лемматизация текстов в датасете.

Данные были разделены на обучающую и тестовую выборки в соотношении 3:1 с учетом дисбаланса классов в целевом признаке. Для определения тональности текстов были найдены величины TF-IDF для обучающего и тестового корпусов.

Были построены и обучены модели `LogisticRegression`, `LGBMClassifier` и `CatBoostClassifier` с помощью поиска по сетке гиперпараметров с учетом необходимости балансировки классов. В результате по критерию качества предсказания наилучшей оказалась модель **`LogisticRegression` с *F1-мера* = 0.76** (с взвешиванием классов).

Окончательная проверка качества модели `LogisticRegression` на тестовой выборке показала значение ***F1-мера* 0.76** и ***AUC-ROC* 0.97**.

Адекватность построенной модели подтвердилась путем сравнения значения метрики *AUC-ROC* со значением **0.5** для **случайной модели**.
